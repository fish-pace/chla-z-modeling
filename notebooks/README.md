# CHLA-Z notebooks

This directory contains Jupyter notebooks and supporting utilities used to develop, document, and demonstrate the CHLA-Z global chlorophyll-a vertical distribution dataset.

The notebooks span three main purposes:
1. **Methods development and documentation**
2. **Pipeline construction for producing NetCDF and Zarr outputs**
3. **User-facing examples and exploratory analysis**

Not all notebooks are intended for end users; some are research or pipeline-oriented.

---

## Overview of notebooks

### `examples.ipynb`
**User-facing example notebook.**

Demonstrates how to:
- Access CHLA-Z data from public Google Cloud Storage
- Stream cloud-optimized Zarr data using xarray
- Load and plot daily NetCDF files
- Extract time series and vertical slices

This notebook is intended as the primary **getting-started example** and is linked from the main README and Colab.

---

### `methods_fit_BRT_CHLA_z.ipynb`
**Model training and fitting notebook.**

Documents the process used to:
- Prepare training data from Bio-Argo profiles and remote-sensing inputs
- Fit boosted regression tree (BRT) models for predicting vertical chlorophyll structure
- Evaluate model performance across depth bins and regions
- Save trained model artifacts

This notebook reflects **method development work** and may evolve as models are refined.

---

### `methods_global_daily_netcdf.ipynb`
**Methods for generating daily global NetCDF outputs.**

Covers:
- Applying trained models to daily global inputs
- Writing gridded daily NetCDF files
- Managing variable metadata, dimensions, and encoding
- Ensuring consistency across daily outputs

This notebook focuses on the **production methodology** rather than interactive analysis.

---

### `pipeline_chla_z_netcdfs.ipynb`
**End-to-end pipeline for NetCDF generation.**

Implements a more operational workflow that:
- Ingests daily remote-sensing inputs
- Applies trained BRT models
- Produces daily CHLA-Z NetCDF files
- Organizes outputs for downstream access and archiving

This notebook represents a **pipeline prototype** and may be refactored into scripts or workflows.

---

### `pipeline_zarr_store.ipynb`
**Pipeline for building the Zarr v3 cloud-optimized data store.**

Demonstrates how daily NetCDF outputs are:
- Consolidated into a chunked Zarr store
- Written with cloud-friendly chunking and metadata
- Prepared for efficient streaming access via xarray and other tools

This notebook supports the cloud-native access pattern used by CHLA-Z.

---

### `ml_utils.py`
**Shared machine-learning utility functions.**

Contains helper functions used across notebooks, such as:
- Feature preparation
- Model application helpers
- Reusable evaluation or transformation routines

This file supports the notebooks above and is not intended as a standalone library.

---

## Notes on use

- Notebooks prefixed with `methods_` and `pipeline_` are **research and production-oriented**.
- `examples.ipynb` is the recommended entry point for new users.
- Outputs generated by these notebooks are hosted separately in public Google Cloud Storage and are not committed to this repository.

---

## Status

These notebooks reflect an **active research and development workflow**.  
Methods, pipelines, and implementation details may change as validation and uncertainty characterization progress.

For stable dataset access and documentation, see:
- The repository root `README.md`
- The dataset landing page (`docs/index.html`)
- The CHLA-Z metadata file (`chla-z.json`)
